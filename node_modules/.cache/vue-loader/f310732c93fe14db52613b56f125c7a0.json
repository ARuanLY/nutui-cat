{"remainingRequest":"/Users/ailu/Documents/program/nutui-lu/nutui-cat/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ailu/Documents/program/nutui-lu/nutui-cat/src/packages/sharecoupon/index.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/ailu/Documents/program/nutui-lu/nutui-cat/src/packages/sharecoupon/index.vue","mtime":1631169319480},{"path":"/Users/ailu/Documents/program/nutui-lu/nutui-cat/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ailu/Documents/program/nutui-lu/nutui-cat/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/ailu/Documents/program/nutui-lu/nutui-cat/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/ailu/Documents/program/nutui-lu/nutui-cat/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ailu/Documents/program/nutui-lu/nutui-cat/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7IGNyZWF0ZUNvbXBvbmVudCB9IGZyb20gJ0AvdXRpbHMvY3JlYXRlJzsKaW1wb3J0IHsgVG9hc3QgfSBmcm9tICdAbnV0dWkvbnV0dWknOwpjb25zdCB7IGNvbXBvbmVudE5hbWUsIGNyZWF0ZSB9ID0gY3JlYXRlQ29tcG9uZW50KCdzaGFyZUNvdXBvbicpOwpjb25zdCBfdG9hc3Q6IGFueSA9IFRvYXN0OwpleHBvcnQgZGVmYXVsdCBjcmVhdGUoewogIHByb3BzOiB7CiAgICBpdGVtOiB7CiAgICAgIHR5cGU6IFtBcnJheSwgT2JqZWN0XSwKICAgICAgZGVmYXVsdDogW10KICAgIH0sCiAgICBpbWFnZTogewogICAgICB0eXBlOiBbU3RyaW5nLCBCb29sZWFuXSwKICAgICAgZGVmYXVsdDogJycKICAgIH0sCiAgICB0YWc6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnJwogICAgfSwKICAgIHR5cGU6IHsKICAgICAgdHlwZTogW1N0cmluZywgTnVtYmVyXSwKICAgICAgZGVmYXVsdDogJycKICAgIH0KICB9LAogIGRhdGEoKSB7CgkJcmV0dXJuIHsKICAgICAgc3RhdGU6ICcnCiAgICB9OwoJfSwKICBjb21wb25lbnRzOiB7fSwKICBtb3VudGVkKCkgewogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGNsYXNzZXMoKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgW2NvbXBvbmVudE5hbWVdOiB0cnVlLAogICAgICAgIFtgJHtjb21wb25lbnROYW1lfS0keyh0aGlzIGFzIGFueSkudHlwZX1gXTogKHRoaXMgYXMgYW55KS50eXBlLAogICAgICAgIFtgJHtjb21wb25lbnROYW1lfS0keyhbJ2dldCcsJ3VzZScsJ2JhbiddIGFzIGFueSlbKHRoaXMgYXMgYW55KS5zdGF0ZV19YF06ICh0aGlzIGFzIGFueSkuc3RhdGUKICAgICAgfTsKICAgIH0sCiAgICBjbGFzc2VzQ29udCgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBbYCR7Y29tcG9uZW50TmFtZX0tY29udGBdOiB0cnVlCiAgICAgIH07CiAgICB9LAogICAgY2xhc3Nlc0luZm8oKSB7CiAgICAgIHJldHVybiB7CiAgICAgICAgW2Ake2NvbXBvbmVudE5hbWV9LWluZm9gXTogdHJ1ZQogICAgICB9OwogICAgfSwKICAgIHN0eWxlcygpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICAvLyAnYm9yZGVyLXJhZGl1cyc6ICgodGhpcyBhcyBhbnkpIGFzIGFueSkucmFkaXVzICsgJ3B4JwogICAgICB9OwogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIC8vIOWkhOeQhuWIuOeahOWtl+auteaVsOaNrgogICAgc3dpdGNoICh0aGlzLnR5cGUpIHsKICAgICAgY2FzZSAnc2hhcmUnOiB0aGlzLnNldFNoYXJlQ291cG9uKCk7IGJyZWFrOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8g5YiG5Lqr5Yi4CiAgICBzZXRTaGFyZUNvdXBvbigpIHsKICAgICAgbGV0IGNwblJlc3VsdENvZGUsc29sZE91dDsKICAgICAgLy8g5aSE55CG6Leo5ZOB57G75ouJ5paw5Yi455qE5a2X5q616L+H5rukCiAgICAgIGxldCBleHQgPSAodGhpcyBhcyBhbnkpLml0ZW0uZXh0ZW5zaW9uCiAgICAgIGxldCB7IHBpY3R1cmVMaW5rIH0gPSBleHQKICAgICAgZXh0LnVfaW1nID0gcGljdHVyZUxpbmsgPyBgaHR0cHM6Ly9tLjM2MGJ1eWltZy5jb20vbW9iaWxlL2pmcyR7cGljdHVyZUxpbmsuc3BsaXQoJy9qZnMnKVsxXX1gIDogJycKICAgICAgCiAgICAgIGV4dC51X3RpdCA9ICh0aGlzIGFzIGFueSkuY2xlYW5aZXJvKGV4dC5kaXNjb3VudCkKICAgICAgZXh0LnVfbGluZTEgPSAodGhpcyBhcyBhbnkpLmNsZWFuWmVybyhleHQucXVvdGEpCiAgICAgIGV4dC51X2xpbmUyID0gKHRoaXMgYXMgYW55KS5pdGVtLmRlc2MgPyAodGhpcyBhcyBhbnkpLml0ZW0uZGVzYyA6IGV4dC5saW1pdFN0cgogICAgICBjb25zb2xlLmxvZygndV90aXQgMTEnLCBleHQudV90aXQpCiAgICAgIC8vIOmHkemineOAgemXqOanm+iuvue9rgoKICAgICAgZXh0LnVfbGluZTEgPSArZXh0LnF1b3RhID8gYOa7oSR7KHRoaXMgYXMgYW55KS5jbGVhblplcm8oZXh0LnF1b3RhKX3lhYPlj6/nlKhgIDogJ+aXoOmXqOanmyc7CiAgICAgICh0aGlzIGFzIGFueSkuJHNldCgodGhpcyBhcyBhbnkpLml0ZW0sICdleHRlbnNpb24nLCBleHQpOwogICAgICAvLyBjb25zb2xlLmxvZygnZXh0MjIyJywgKHRoaXMgYXMgYW55KS5pdGVtLmV4dGVuc2lvbikKICAgICAgY3BuUmVzdWx0Q29kZT0odGhpcyBhcyBhbnkpLml0ZW0uZXh0ZW5zaW9uLmNwblJlc3VsdENvZGU7CiAgICAgIHNvbGRPdXQ9KHRoaXMgYXMgYW55KS5pdGVtLmV4dGVuc2lvbi5zb2xkT3V0OwogICAgICAvLyDorr7nva7liLjnirbmgIEKICAgICAgaWYgKGNwblJlc3VsdENvZGUgPT0gMTQgfHwgY3BuUmVzdWx0Q29kZSA9PSAxNSkgewogICAgICAgICh0aGlzIGFzIGFueSkuc3RhdGUgPSAxOyAvLyDpoobov4cKICAgICAgfSBlbHNlIGlmIChjcG5SZXN1bHRDb2RlID09IDE2IHx8IGNwblJlc3VsdENvZGUgPT0gMTcgfHwgc29sZE91dCkgewogICAgICAgICh0aGlzIGFzIGFueSkuc3RhdGUgPSAyOyAvLyDlt7LmiqLlhYkKICAgICAgfSBlbHNlIHsKICAgICAgICAodGhpcyBhcyBhbnkpLnN0YXRlID0gMDsgLy8g5pyq6aKG5Y+WCiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVDbGljaygpIHsKICAgICAgLy8gKHRoaXMgYXMgYW55KS4kZW1pdCgnY2xpY2stcmVwb3J0JywgKHRoaXMgYXMgYW55KS5zdGF0ZSk7CiAgICAgICh0aGlzIGFzIGFueSkuJGVtaXQoJ2NsaWNrLXJlcG9ydCcpOwogICAgfSwKICAgIGNsZWFuWmVybyAodmFsdWU6IHN0cmluZykgewogICAgICB2YWx1ZSA9IHZhbHVlCiAgICAgIGxldCByZXMgPSAvXC4wKyQvLmV4ZWModmFsdWUpCiAgICAgIGlmIChyZXMpIHsKICAgICAgICByZXR1cm4gdmFsdWUuc2xpY2UoMCwgcmVzLmluZGV4KQogICAgICB9CiAgICAgIHJldHVybiB2YWx1ZQogICAgfQogIH0KfSk7Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAmBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/packages/sharecoupon","sourcesContent":["<template>\n  <div :class=\"classes\" :style=\"styles\" @click=\"handleClick()\">\n    <nutcat-image class=\"sub-image\" :src=\"item.extension.u_img\"></nutcat-image>\n    <div :class=\"classesInfo\">\n      <nutcat-text class=\"sub-price\" row=\"1\"><i class=\"rmb\">&yen;</i>{{item.extension.u_tit}}</nutcat-text>\n      <nutcat-text class=\"sub-limitStr\" row=\"1\">{{item.extension.u_line1}}</nutcat-text>\n    </div> \n    <div :class=\"classesCont\">\n      <nutcat-text class=\"sub-name\" row=\"1\">{{item.extension.shopName}}</nutcat-text>\n      <div class=\"sub-btn\">\n        <div>分享领券</div>\n      </div>\n    </div>\n\n    <slot></slot>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { createComponent } from '@/utils/create';\nimport { Toast } from '@nutui/nutui';\nconst { componentName, create } = createComponent('shareCoupon');\nconst _toast: any = Toast;\nexport default create({\n  props: {\n    item: {\n      type: [Array, Object],\n      default: []\n    },\n    image: {\n      type: [String, Boolean],\n      default: ''\n    },\n    tag: {\n      type: String,\n      default: ''\n    },\n    type: {\n      type: [String, Number],\n      default: ''\n    }\n  },\n  data() {\n\t\treturn {\n      state: ''\n    };\n\t},\n  components: {},\n  mounted() {\n  },\n  computed: {\n    classes() {\n      return {\n        [componentName]: true,\n        [`${componentName}-${(this as any).type}`]: (this as any).type,\n        [`${componentName}-${(['get','use','ban'] as any)[(this as any).state]}`]: (this as any).state\n      };\n    },\n    classesCont() {\n      return {\n        [`${componentName}-cont`]: true\n      };\n    },\n    classesInfo() {\n      return {\n        [`${componentName}-info`]: true\n      };\n    },\n    styles() {\n      return {\n        // 'border-radius': ((this as any) as any).radius + 'px'\n      };\n    }\n  },\n  created() {\n    // 处理券的字段数据\n    switch (this.type) {\n      case 'share': this.setShareCoupon(); break;\n    }\n  },\n  methods: {\n    // 分享券\n    setShareCoupon() {\n      let cpnResultCode,soldOut;\n      // 处理跨品类拉新券的字段过滤\n      let ext = (this as any).item.extension\n      let { pictureLink } = ext\n      ext.u_img = pictureLink ? `https://m.360buyimg.com/mobile/jfs${pictureLink.split('/jfs')[1]}` : ''\n      \n      ext.u_tit = (this as any).cleanZero(ext.discount)\n      ext.u_line1 = (this as any).cleanZero(ext.quota)\n      ext.u_line2 = (this as any).item.desc ? (this as any).item.desc : ext.limitStr\n      console.log('u_tit 11', ext.u_tit)\n      // 金额、门槛设置\n\n      ext.u_line1 = +ext.quota ? `满${(this as any).cleanZero(ext.quota)}元可用` : '无门槛';\n      (this as any).$set((this as any).item, 'extension', ext);\n      // console.log('ext222', (this as any).item.extension)\n      cpnResultCode=(this as any).item.extension.cpnResultCode;\n      soldOut=(this as any).item.extension.soldOut;\n      // 设置券状态\n      if (cpnResultCode == 14 || cpnResultCode == 15) {\n        (this as any).state = 1; // 领过\n      } else if (cpnResultCode == 16 || cpnResultCode == 17 || soldOut) {\n        (this as any).state = 2; // 已抢光\n      } else {\n        (this as any).state = 0; // 未领取\n      }\n    },\n    handleClick() {\n      // (this as any).$emit('click-report', (this as any).state);\n      (this as any).$emit('click-report');\n    },\n    cleanZero (value: string) {\n      value = value\n      let res = /\\.0+$/.exec(value)\n      if (res) {\n        return value.slice(0, res.index)\n      }\n      return value\n    }\n  }\n});\n</script>\n\n<style lang=\"scss\">\n@import 'index.scss';\n</style>\n"]}]}