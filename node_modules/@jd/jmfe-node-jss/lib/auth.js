/**
 * @file
 * @author Zeng Tong
 * Created on 2017-09-07.
 */

'use strict';
const crypto = require('crypto');

function auth(options, accessKey, secretKey) {
    var strToSign = [
        options.method
        , options.headers['content-md5'] || ''
        , options.headers['content-type'] || ''
        , options.headers.date
        , decodeURI(options.uri)
    ].join('\n');
    var token = crypto.createHmac('sha1', secretKey)
        .update(strToSign, 'utf8')
        .digest('base64');
    return 'jingdong ' + accessKey + ':' + token;
}

module.exports = auth;
